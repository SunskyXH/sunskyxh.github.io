<!DOCTYPE html>
<html lang=en,zh-cn,default>
  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="description" content="这里什么都没有">
  <meta name="keywords" content="undefined">
  
    <link rel="icon" href="">
  
  <title>Reason简介</title>
  <link rel="stylesheet" href="/css/style.css">
<link rel="stylesheet" href="/css/atom-one-light.css">
<link rel="stylesheet" href="/css/font-awesome.min.css">
  <script src="/js/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
</head>
<body>
  <div class="wrapper">
    <div class="default_title">
        <img src="/imgs/mycomputer.png" />
        <h1>香香鸡的小窝</h1>
    </div>
    <ul class="topbar">
    
        <li>
        <a href="/" class="item-link">首页</a>
        </li>
    
        <li>
        <a href="/about" class="item-link">关于</a>
        </li>
    
    </ul>
    <div class="tag_list">
    <ul id="tag-list">
        <li><a href="/" ><img src="/imgs/disk.png" />(C:)</a>
        <ul>
        
            <li>
            <a href="/tags/GraphQL" title="GraphQL" rel="1">
                <img src="/imgs/folder.ico" />
                GraphQL
            </a>
            </li>    
        
            <li>
            <a href="/tags/Relay" title="Relay" rel="1">
                <img src="/imgs/folder.ico" />
                Relay
            </a>
            </li>    
        
            <li>
            <a href="/tags/Vue" title="Vue" rel="3">
                <img src="/imgs/folder.ico" />
                Vue
            </a>
            </li>    
        
            <li>
            <a href="/tags/javascript" title="javascript" rel="3">
                <img src="/imgs/folder.ico" />
                javascript
            </a>
            </li>    
        
            <li>
            <a href="/tags/Typescript" title="Typescript" rel="1">
                <img src="/imgs/folder.ico" />
                Typescript
            </a>
            </li>    
        
            <li>
            <a href="/tags/redux-saga" title="redux-saga" rel="1">
                <img src="/imgs/folder.ico" />
                redux-saga
            </a>
            </li>    
        
            <li>
            <a href="/tags/redux-observable" title="redux-observable" rel="1">
                <img src="/imgs/folder.ico" />
                redux-observable
            </a>
            </li>    
        
            <li>
            <a href="/tags/React" title="React" rel="1">
                <img src="/imgs/folder.ico" />
                React
            </a>
            </li>    
        
            <li>
            <a href="/tags/Preact" title="Preact" rel="1">
                <img src="/imgs/folder.ico" />
                Preact
            </a>
            </li>    
        
            <li>
            <a href="/tags/Virtual DOM" title="Virtual DOM" rel="1">
                <img src="/imgs/folder.ico" />
                Virtual DOM
            </a>
            </li>    
        
            <li>
            <a href="/tags/Reason" title="Reason" rel="1">
                <img src="/imgs/folder.ico" />
                Reason
            </a>
            </li>    
        
            <li>
            <a href="/tags/OCaml" title="OCaml" rel="1">
                <img src="/imgs/folder.ico" />
                OCaml
            </a>
            </li>    
        
            <li>
            <a href="/tags/bucklescript" title="bucklescript" rel="1">
                <img src="/imgs/folder.ico" />
                bucklescript
            </a>
            </li>    
        
        </ul>
    </ul>
    </div>
    <div class="post_list">
    <ul>
        
            <li>
            <a href="/2017/02/22/GraphQL-Relay-first-explore/">
            <img src="/imgs/file.ico" />
                GraphQL+Relay初探
            </a>
            </li>
        
            <li>
            <a href="/2016/08/20/The-State-of-Vue/">
            <img src="/imgs/file.ico" />
                The State of Vue(自译)
            </a>
            </li>
        
            <li>
            <a href="/2017/04/05/6-reasons-why-javascripts-async-await-blows-promises-away/">
            <img src="/imgs/file.ico" />
                Async/Await胜过Promise的6个理由（自译）
            </a>
            </li>
        
            <li>
            <a href="/2018/03/12/dose-refactoring-vue-project-into-typescript-deserved/">
            <img src="/imgs/file.ico" />
                有必要将Vue项目重构到Typescript吗?
            </a>
            </li>
        
            <li>
            <a href="/2017/03/30/i-dont-know-js/">
            <img src="/imgs/file.ico" />
                我不懂的js集合
            </a>
            </li>
        
            <li>
            <a href="/2016/09/10/vue-directive-to-highlight-code/">
            <img src="/imgs/file.ico" />
                vue自定义指令实现Highlight.js高亮代码
            </a>
            </li>
        
            <li>
            <a href="/2017/02/26/preact-virtual-DOM-algorithm-explore/">
            <img src="/imgs/file.ico" />
                Preact Virtual DOM算法探究
            </a>
            </li>
        
            <li>
            <a href="/2017/12/17/reason-intro/">
            <img src="/imgs/file.ico" />
                Reason简介
            </a>
            </li>
        
    </ul>
    </div>

    <div class="post_total">
        
            <div class="left">8 object(s)</div>
        
        <div class="right">&nbsp;</div>
    </div>
</div>
  <div class="content">
    <div class="post_title">
      <img src="/imgs/file.png" />
      <h1>Reason简介</h1>
      <a href="/"><div class="btn"><span class="fa fa-times"></span></div></a>
      <div class="btn btn_max"><span class="fa fa-window-maximize"></span></div>
      <div class="btn"><span class="fa fa-window-minimize"></span></div>
    </div>
    <ul class="topbar">
      <li>Sun Dec 17 2017 13:06:23 GMT+0800</li>
    </ul>
    <div class="post_content">
      <h2 id="Reason是什么"><a href="#Reason是什么" class="headerlink" title="Reason是什么"></a>Reason是什么</h2><p>Reason是facebook团队开发的OCaml的一种新语法，其目的是给OCaml类似JavaScript的语法以便JavaScript程序员使用，并通过BuckleScript编译成JavaScript。<br>同时ES新特性的很多草案是从OCaml中引入的，比如管道操作符 <code>|&gt;</code>，直接使用Reason能提前爽到这些东西（官方称这些特性在ECMAScript中甚至排到了ES2030），并且Reason也能享受到Javascript和OCaml的生态，例如你依然能够使用npm/yarn，或者opam。在构建应用方面，也有ReasonReact等库。</p>
<h2 id="特性"><a href="#特性" class="headerlink" title="特性"></a>特性</h2><ul>
<li>类型有着100%的覆盖率，能自动推断类型，一旦编译，类型会保证是明确的</li>
<li>在大多数是纯函数（pure）、不可变（immtuable）、函数式（functional）的同时，有可选的副作用（side-effect)和数据突变(mutation)</li>
<li>编译快速且产生的体积小</li>
<li>能转换使用js的代码，同时依然能用js的生态系统</li>
</ul>
<h2 id="与JavaScript语法的联系"><a href="#与JavaScript语法的联系" class="headerlink" title="与JavaScript语法的联系"></a>与JavaScript语法的联系</h2><p>虽然Reason很大程度上是提供给JavaScript开发人员使用的，但实际上其很多语法设计是基于OCaml，在实际使用中有不少地方值得注意。</p>
<h3 id="句末的分号"><a href="#句末的分号" class="headerlink" title="句末的分号"></a>句末的分号</h3><p>JavaScript中句末分号是可选的，Reason中分号有自己的规定，有些地方必须有分号，有些地方不可以用分号，并且是有着意义的。<br><figure class="highlight ocaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">/* <span class="type">OCaml</span> syntax*/</div><div class="line"><span class="keyword">let</span> a = <span class="number">1</span> <span class="keyword">in</span></div><div class="line"><span class="keyword">let</span> b = <span class="number">2</span> <span class="keyword">in</span></div><div class="line">a + b</div><div class="line"></div><div class="line">/* <span class="type">Reason</span> syntax */</div><div class="line"><span class="keyword">let</span> a = <span class="number">1</span>;</div><div class="line"><span class="keyword">let</span> b = <span class="number">2</span>;</div><div class="line">a + b;</div></pre></td></tr></table></figure></p>
<h3 id="类型"><a href="#类型" class="headerlink" title="类型"></a>类型</h3><p>JavaScript是典型的弱类型语言，也出现过TypeScript或者Flow等语言或工具来增强JavaScript的类型。在这一点上，Reason本身是能自动推断类型的，同时也可以使用<code>:</code>去标注类型，例如<code>let foo: int = 10;</code>。这种形式和TS、flow非常相似。<br>不过Reason没有泛型的概念, 要想声明类似一个又有int又有float的tuple需要这样<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">type myTuple = (int, float, int);</div><div class="line">let realMyTuple: myTuple = (1, 1.1, 2);</div></pre></td></tr></table></figure></p>
<p>Reason的list的元素必须为同一类型，所以不需要<code>List&lt;String&gt;</code>这种操作了。</p>
<h3 id="let关键字"><a href="#let关键字" class="headerlink" title="let关键字"></a>let关键字</h3><p>JavaScript在ES6中引入的let关键字用于声明块级作用域的变量，相同的是Reason中也有块级作用域这一概念，但是在Reason中let强调的是绑定(binding)这一概念，let绑定的变量是immtuable的.这意味这声明变量以后无法简单的直接修改值(类似es6的const关键字）。要想类似es6的let关键字声明可变变量的话，可以使用ref关键字，<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">let foo = &quot;bar&quot;;</div><div class="line">Js.log(foo); /* bar */</div><div class="line">foo = &quot;foo&quot;; /* Error:The value foo is not an instance variable */</div><div class="line"></div><div class="line">let x = ref(5); /* similar to let x = 5 is ES6 */</div><div class="line">x := x^ + 1; /* similar to let x = x + 1 */</div></pre></td></tr></table></figure></p>
<h3 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h3><p>Reason中不能使用<code>//</code>单行注释，请使用<code>/* */</code>。</p>
<h3 id="单引号和双引号"><a href="#单引号和双引号" class="headerlink" title="单引号和双引号"></a>单引号和双引号</h3><p>在JavaScript中没有字符和字符串的区别，单双引号区别也基本只是在转义上。<br>Reason中有字符串(String)和字符(Characters)的区别，字符串使用双引号，字符使用单引号。</p>
<h3 id="操作符的使用"><a href="#操作符的使用" class="headerlink" title="+操作符的使用"></a>+操作符的使用</h3><p>在JavaScript中<code>+</code>不仅是加法运算，同时也可以是链接字符串的操作符，而且有着比如”1”+2 = “12”这种很神奇的类型转换的问题。<br>而在Reason中，单独的<code>+</code>用于整数加法运算，浮点数的加法运算会使用<code>+.</code>，链接字符串使用<code>++</code>。<br>Reason中其他运算符，整数型和浮点型也是不同的操作符，浮点型的操作符会多一个<code>.</code>。</p>
<h3 id="、-和布尔值"><a href="#、-和布尔值" class="headerlink" title="===、==和布尔值"></a>===、==和布尔值</h3><p>JavaScript中两种等的区别为是否严格相等，<code>===</code>除了会去比较值以外还会去比较类型和引用。<br>Reason中的<code>==</code>叫做physical equal，<code>===</code>叫做 referential equal，<code>==</code>会去深检查数据结构，<code>===</code>只会检查引用（浅检查, 和js的===是类似的）。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Js.log((1,2) == (1,2)); /* true */</div><div class="line">Js.log((1,2) === (1,2)); /* false */</div><div class="line">let someTuple = (1,2);</div><div class="line">Js.log(someTuple === someTuple); /* true */</div></pre></td></tr></table></figure></p>
<p>实际上在Reason通过bucklescript编译成JavaScript的后的代码里，<code>==</code>会被编译成<code>Caml_obj.caml_equal()</code>，<code>===</code>依然是<code>===</code>。<br>Reason的布尔值true，false表面上和JavaScript的布尔值是一回事，但在编译中会被编译为<code>Js.true_</code>和<code>Js.false_</code>。</p>
<h3 id="null-undefined"><a href="#null-undefined" class="headerlink" title="null undefined"></a>null undefined</h3><p>JavaScript中很有名的null和undefined，null表示不存在，undefined表示未定义，在Reason中统统用None代替了。</p>
<h3 id="数据结构类型"><a href="#数据结构类型" class="headerlink" title="数据结构类型"></a>数据结构类型</h3><p>JavaScript是基于原型的语言，所有类型都能追溯到Object.prototype，这导致无论是Array还是Object都在一定程度上有着相似性，比如Array和Object都是mutable的，这也是我们需要immtuable.js的原因之一。同时ES6中引入了迭代器(iterator)的概念，Array，Map，Set等都是基于迭代器实现的。<br>而Reason中的数据结构多种多样，其中最类似JavaScript里Object的Record则是默认immutable的。用<code>[]</code>创建的数据结构在Reason中是List，是immtuable的，创建Array则需要使用<code>[||]</code>。<br>需要注意的是，Reason的list里的元素必须为同一类型，Array为定长，这点与JavaScript有很大区别。</p>
<h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><p>JavaScript中使用function关键字声明函数，在ES6中引入了箭头函数（Arrow Function）。Reason中没有function关键字，使用<code>=&gt;</code>来声明函数，装参数的括号不可以省略，参数可以使用<code>~</code>来标注到对应的参数名(像是React中给某个组件传递props然后调用该组件的this.props.名字去获取props的值)。<br>由于Reason是函数式的，没有<code>return</code>关键字，函数都可以部分调用，很方便科里化（currying），例如<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">let add = (x, y) =&gt; x + y;</div><div class="line">let process = add(1);</div><div class="line">let firstAnswer = process(2); /* firstAnswer = 3 */</div><div class="line">let secondAnswer = process(3); /* firstAnswer = 4 */</div><div class="line"></div><div class="line">/* 实际上add是类似于如下方式声明的 */</div><div class="line">let add = (x) =&gt; (y) =&gt; x + y;</div></pre></td></tr></table></figure></p>
<p>因此要注意的是，调用函数时传递的参数少于函数参数的个数时并不是不传递参数而是部分调用该函数，要想实现类似JavaScript中可选参数的话需要使用<code>?</code>来标注可选参数。</p>
<h3 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h3><p>在没有Array.map等函数或者迭代器的年代要用原生js遍历数组得老老实实写for循环，不过在Reason中for循环非常简单<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">for (i in 0 to 10) &#123;...&#125;</div><div class="line">/* 还能倒着来，没想到吧 */</div><div class="line">for (i in 10 downto 0) &#123;...&#125;</div></pre></td></tr></table></figure></p>
<p>while循环则是大致相同</p>
<h3 id="解构-Destructuring"><a href="#解构-Destructuring" class="headerlink" title="解构(Destructuring)"></a>解构(Destructuring)</h3><p>ES6的解构为书写代码带来了很大的便利，同时如果用的非常熟练，能写出很多简介明了的代码，Reason中同样支持了解构，并且大致与ES6的解构相似。非要说不一样的话那就是多了元组(tuple)的解构<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">let myTuple = (&quot;やじゅう&quot;, &quot;せんぱい&quot;);</div><div class="line">let (yj, snpi) = myTuple;</div></pre></td></tr></table></figure></p>
<h3 id="switch"><a href="#switch" class="headerlink" title="switch"></a>switch</h3><p>二者的switch都是拿来替代大量的if/else结构，不过Reason的switch功能结合Variant和Pattern Matching使用会变得非常强大，能极大程度的让代码变得简洁优雅，不过这里只是比较与JavaScript的异同，就不展开讲了。</p>
<h3 id="异常"><a href="#异常" class="headerlink" title="异常"></a>异常</h3><p>JavaScript能使用throw抛出异常或者try catch finally结构来处理异常，Reason中使用raise来抛出异常，使用try foo { |Err =&gt; something}来处理异常，不过要注意没有finally。</p>
<h3 id="JSX"><a href="#JSX" class="headerlink" title="JSX"></a>JSX</h3><p>JSX能够使用类似html标签的语法来使用组件，Reason依然继承了这个特点，但在某些语法上有略微不同。<br>JSX中props如果只写props名字，则会被当作true，比如<code>&lt;myInput checked /&gt;</code>, 而在Reason中这会被解释为<code>&lt;myInput checked={checked} /&gt;</code>。这一点被称为Argument punning。另外，如果是使用jsx来开发react应用的话，已经有ReasonReact了。</p>
<h3 id="转化为js"><a href="#转化为js" class="headerlink" title="转化为js"></a>转化为js</h3><p>Reason可以使用<code>[%%bs.raw {||}]</code>或<code>[%bs.raw {||}]</code>来将执行js的代码（这里的一个%和两个%区别很大，暂不展开讲）。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>Reason有着大量OCaml优雅语法的优点，同时对JavaScript开发者非常友好，相应的生态也有非常好的支持，对于爱折腾的个人开发者来说不失为一个有趣好玩的新鲜事物。</p>

    </div>
</div>
  <footer class="footer">
  <p> powered by hexo</p>
</footer>
<script>
  var max = document.getElementsByClassName("btn")[1];
  var min = document.getElementsByClassName("btn")[2];

  function maximize () {
    var post = document.getElementsByClassName("content")[0];
    var cont = document.getElementsByClassName("post_content")[0];
    var wid = window.innerWidth || document.documentElement.clientWidth || document.getElementsByTagName("body")[0].clientWidth;

    if (wid > 900) {
      widf = wid * 0.9;
      post.style.width = widf + "px";

      if (wid < 1400) {
        cont.style.width = "99%";
      } else {
        cont.style.width = "99.4%";
      }
    }
  }

  function minimize () {
    var post = document.getElementsByClassName("content")[0];
    var cont = document.getElementsByClassName("post_content")[0];
    var wid = window.innerWidth || document.documentElement.clientWidth || document.getElementsByTagName("body")[0].clientWidth;

    if ( wid > 900 ) {
      post.style.width = "800px";
      cont.style.width = "98.5%";
    }
  }

  max && max.addEventListener('click', maximize, false);
  min && min.addEventListener('click', minimize, false);

</script>
</body>
</html>